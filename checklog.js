/**
 * @author Heyboi
 * @name 青龙日志检测
 * @origin Heyboi自用
 * @version 1.0.3
 * @rule ^日志检测$
 * @rule ^checklog$
 * @rule ^(checklog|青龙日志检测)(开|关| on| off)$
 * @admin true
 * @public false
 * @priority 99999
 * @cron *\/30 * * * * *
 * @disable false
 * 
 * 说明：
    1、（必须）在红灯区同级目录创建一个文件夹，名字随意 如：自用插件
    2、仅超授可用
    3、设置 （panelIndex） 执行面板 对应红灯区奶酪棒位置，从0开始
    4、设置插件开关方式二选一：(默认插件关闭)
        方式1：管理员发送set Heyboi checklogSwitch on/off 设置开关（on为启动插件off为关）
        方式2：管理员发送 青龙日志检测开/关 checklog on/off（英文中间有空格，中文没）
 * 注意：
    本插件只针对运行的任务进行判断，去重列表每天刷新。
    excludeKeywords过滤是匹配青龙面板的任务名称，必须一字不差！
    有些脚本接口本身就是403或者493，请及时过滤以免频繁重拨！！！！
    定时（@cron）自己设置，默认30秒
 * 更新：
    5.12  1.0.0版本发布
    
    5.12  1.0.1  支持指定临时日志存放地址，支持推送到第三方bot重拨
                 使用tgBot推送检测日志，支持日志检测开关

    5.15  1.0.2  支持指定日志检测,变量名：checkTask，指定任务检测和任务过滤互斥
                 如果都有值则以指定日志检测为准。
                 
    6.6   1.0.3  fix bug


 * */



const fs = require('fs');
const QlMod = require("../红灯区/mod/AmQlMod");
const AmTool = require("../红灯区/mod/AmTool");
const axios = require('axios').default;
// 临时日志存放地址
const filePath = 'BncrData/plugins/自用插件'
// 需要运行的面板编号
const panelIndex = 0
//指定任务检测,格式为['京东资产变动','东东农场日常任务']
const checkTask = [];
// 任务过滤,格式为['京东资产变动','东东农场日常任务']
const excludeKeywords = ['京东资产变动','汪汪乐园每日任务'];
// 匹配正则
const regex = /IP 493|ip已被限制|code 403/
// 重拨触发词
const key = '重拨'
// 重拨词发送参数,user_id,group_id默认为空，只有第三方bot重拨才需要填
// bncr重拨插件填写会导致无法触发
const push_info = {
    platform: 'HumanTG',//推送平台
    user_id: '',
    group_id: '',
}
 /** Code Encryption Block[419fd178b7a37c9eae7b7426c4a04203d45e01cd4c8344ffddd8d874f1b64a318191f9514b98d644c03366d9e6625065bb3ada9d277a8f6fb930971e0048b983682a0a997b598f726353e8fdd7adfb165df28759839b20c3a9875fc9fb97aa312c3cef47afe588ed865f3bd39d741abfae8b522d26d6b1935efa27cc3c01cbf3c63d4e1908df90e02a75723a78ecc0f754d87f8f625984627349bded7b173800fbc0c4936e3eb090d57a82671ce51c99f97116e71bda12e3c3a7d353d357e4afd558c5a3c3fa47ec2cd7c924e37ab3c2bec8efa5317b3e6b823884aa8a0c49e8619e2be4d369b13afce7abed7d077e2beffbcc0b51cadadc1cd9764aff3270bf18d28eb1f4a2c7fed827bc6f874998e51e2c456a4c5fd0d13edfb7a93f4597990017046973900ba1982984677d866d289425642e2abb0ec9e1b44e14ff4a8d1d9adb9e5bb03be10ec5c0d89b58ac556868050cfaf710ab51a6e41f372afc5c6e7a7ccbf038f418f616bbdfa140bf0194767a7748159e531330089c4c63a04d4a2d5d32fbd239d40a971b83ab41e9d44459943acc85e7a3c1953b1fb7448dde9ee8c06ec24643355ad15a86a30833aff469158c605aa3f700a683d8a4c1a150483a98cf9f9c7a760b1b5ffc5b14e9db2a4076b4e2e11ebd59c021188aad3e537953f6af3682541a349835977bc6ab3d75823b6bee0f9bfb1ab721929bd448987a257d0f902296fdfe6a10002d51590ba7af39cc8d250772e63aae3c5fa12da9683fec3c2b615aa54e941fec4f55a063158475f054ecaca68dd8a6ad124c98be5ff1dab330643d0943fe49d1b09bc1c2813283dc7b9ca5fc594f1518183273901e07d39c9efc37711258b4f59f0593d2f85f1716049c92c3d4eff0e82b5c2cfafe3d1350b1980219cdbbe1845d8b43465835d24fb91397994ec76c0919f6a37153eb640314172e7d7cde586c92ccff7ad8017a815911eb27eea58f221a2006d1e2cff376844875328b879553e5c69bb248c9d89a0fd826bc632a94d7d2a0d8dadc1c2dc003d4bf5244de08bb6ce1c993faabfad7e50e5a8f6c412f268b94d4d6475791a7d07e8a6e23de1cbe634bcc64138a791f69dee9cb1866cfc670469c18dffbe9b745615916ba7c2e5ba3f68a3bc08a9bfe77fd1f2b205cdfea758001b5bc996a6d5e3f6920a54f0e8885759c5d29a7b671f881ed302a106a76225ed2f1ef60a701b2a68df40c52251e93d8001e7b1d288371bb5d7031697ae21a454e6067ddc96ffaa0edf167bae56f9838d1064ffeddc7005c3da7d61e089a4a0e4cb9507967cd6d4739f03afd62bfd511984b220956d969f9a72e4de8d5154d826be17184fcbc399f3a9309964c1aaf2f354aae383a44c3a6ec89f21ac5009d3544864f577ac34833dbebbe6b5275db8469f368a9ec9a463aa24d252842420ab16c609b60e9b11c034f9aed0ae84d0c6b40b08c86472c66dc24b3e5c89572cbe91c01c7f0c94387609fceec59fc2d5b4bb967389205e1c674957afff5db7ec1243058b2203c77970e83fc5d9bcc5731fab91b71205dace37bb6ae08e69461323bcdbc2c212662d33d937c915525844420730b6f086bf8e88f8aaac795ca11246c4396e85ddd8b0881ac0b4d882a333d40248a9b81cb83ab04ef60a53d243f79d5bf0c9f96bcd02f1acc928335d6cfc3cabf49514dd3c6b50254bdbe673a6cf341b6058263604afd9cfdb754b60212f9b70af058c40c8bec0c46f6fb4efe3fb2bdb23ad40df4357331e978a434bd1e74f1423baa8eb123fbb50b93b48dc7bce334b3a042947362c5ce6e159f4aa87a2d46168baa15bebd7ace5a45512d1822393fc291db962896a70e970aba3b753ed8ca965ff1d280dea3e342d9a89ef6b09811032d7474b6b0ea9042d4b5d8541efd3a5252516f98471e5d5ddf0ceadc11599e7e01bb309275985a8cded4c5a8879286766b6fa148abbc919c3aeb3e82cc7b5f296b09b5ff4b4bc3fb636ad6cf7d8e5288fc1ccab017dfa3c7e69c70f3e2dcce43e66378c60169cf6a8f7756572550fbafbbc330eda06240a394ed721e5e1432af2a7c32573c65eb1e5d6e2a57f8102c3342d7d2b3fe95d2f2f51cecb8e42c4f4324a2f0698bc355ce4c33fab1d20ffc82ac0ac02a71a0b36682e06c253ca8b8312cb92a7bda62476293ad9e1676a93131678ca8dedc151755a45619e197d1fff802d3f336675639a80547b1bfb35c7003db154991db6302161155b3f35bb55ac180850c0eee9ef4c8c5abc6496ce9a214e3e0856c1283259391d90be612df594f9baa7403ff26efd966f8bb8cbf2eaeb5a032b7c1a7ab1c8fd6c5619b04bf2bed6a1fe16816afb9b1ddb838bf8ea5781e6a8e89496362802f8169bc748e94f7e1a3e8ae2c76215eb3386704af50ea8b9720a85e3ed199794b9473f8cceac96f66489de8d9081e8732ab52d54b08f577aa6f4539142d827349f2d94f221ee91095523ae42426f3434d9c47f051d60ef97af7fca35e842126834e0d0a68951b9e8f1f5e975029180a7cb80e97692438b6abbf979ad7e9c15febb53a7fc3126010918c3e8f518335ae497aa1f2fe320af18a4174806d217f2656c9519696950b6122b4507e1964577549e29d6ff1242832c805ab46e108acc54bb4ee73afba2508fb6c66f926a26d0a0cc7fa7f29f5f85f10019222347ff3155fcee96769706e310e1b462bdfd3bc1f2d272f3cc792467d0182076707416baead08e9cd2add027348d812a4e944564055cc82c6643b3c38f7b0824caa682272f5189079d4c1e543b2c9cfe77375e9c566623de594d08f750765603585ba5606b64a02e3d228ecd253504e12af17ccf1e8be65dd6db920cda9c788c0051a7cb16818a4471812b6fed1ea0b41b0d272ac2c2220a39dbdd5286913846829b4012bf99bdf42b9a57c6abc7e3bc5ea2b0ceb422b3507f9ecca1fbd492a19db19ef5d0645aea5568963f41cb524ad1473ff31fa46be4cbe371325e1ff973e7744ec2ee9ed8ee5a1bdb071dc7aea79cf7cabf993ebfedf49125f6b659bba18e98bcb8f8eb369a9f37a9f3561bd8a644ec5b10e4a610912bc94b5fa96018dd2dd78a442ada4319f411a9ddfc0713caa2388aff7fc13f136ce5ae6c4dc18a4bdd12eb0d5637ba5b43900bc22e641e59a7804322e40028df0c418bc8f9c9b2ce6b7156f3084156c8dc738f3861e4e4ad5028d6eb9dc2b3f7e280087f33141f56837e3936dfbc15b2cd9cd84f13f877f064d4bbbbb0d7a7cf7f5e947b4d760afd9a612a9afb33728df64423f281cc3a9fb18867898549d9780d580adabed8b7e4d75dbd6724b9ffe121ee01c811f4db657b43e6bf7fff58bc6b6acb78c270f91dc7a8e3cb8bdefc6b239a6d2098b7a97b80340b0105f117fb5e450aa02010f9326843c2f9b83974d66dc088b61e3fbb94b56f85210f77880a2a4d5c2c22bc60d1679b57225ee527b6a92348e0ad3f5ef83d5cba828a1c74644bf533e89e6ebbf76c22a1ac2c4543737106ef46b083805589febd6375684422aaa8f947d4fd20905249f2d713d151e318dd0c311a7ae05c1b352a0f3e3450b50347f52441a3e074baedcb26f9115f1e0315aadfce50581a152ad1f4ddf50de5cc9b060db98f7c04b54232257bd97bb54fb14fe16cc0e11557162999831f51066e6bc4e58884762eb6b390cfade8ca3e1fdc818e740a66603d193b13613c985d4e5d94f909df39ce230ac6fd621190032ae39f4859a20cd9a8b0b5f9f922ef20b254b204d256d21875fe4e1880b3be5d1b3266d5da5c5cc512110f157719c86472f321d681c21ff91b73d342a3927a6cce084988e96bfbbb814aec2824a9b0f2bc07e01d430a6e823b4f3d64f82dca22e091a20871d0aa09a4133654483e82b62eacd7717737d451aaa51a5fdb6df68ab0c13d2e3b6007c829eabe581c7e79c04700d214c1b799f5c6ba74458faa5357141226addb7a429d7ab0288e5eaee0632bd84af427b615f2c364f36b95b4243fdbdb3f559f698d33f069110171512cfec5a834d8314eee1e1be0644beef443816287d8be70abe20e7840725bc073a20f020d910c93c5ae5fc1ce52acb401c1d121d6383c8f02e2d25add186a629ffd742ebf4eac4d8fbe5f342b8ea0dd1f166f85d1c14156559615fecd8d9f9efe8b16eae8c756f0a7d1c59212633801206ee504df0ff000d0816d317a73a711b8f80670870b0f715533a807d017cadcbd4c8a9ce6b887bd331de283d9b36da695d5d475814143807cc6a806134ede69e6210399b6a818b6806630bfaf56a8357b4c0e439b584d439ccc89928685299ada3918f7348d56dc38b98f65ff802b1caebf9ed1ba640605aaefc8593911052a2ff2c4bb82071e584bac78c084da62027fa143371688dbfaa5e37af1b1910464be3816a72599daae7e1860740ce9db506f21ac297d1974e76c41161de62c95cceaaca93d267340219f35c65b3ce2102f614e70d9205ca500c9ffb5ddc6df0762af23bccfc959c56965e8fb244b879cf610fc8e772b580d156a464783d74da753accadd1c7be9d6794e3388c2ecc04b78cceefd3ba28036a56cecd0b9cdb05ed8afbeca7948de1f8494371fc4bd9c485e3b713775343dfa397582f6c15ca618251230946fdcd5923b108ea8d3c0cb39b1353db12e4172e38840b7183aebdc32f460ef8dc55764f949a8fc0db2d7e83152391c2c663a3fc00fd8b05871795a92aa3c3154cdcd0b036da1738c7c93a40b8183caa20b3b5ecd6702bb8b9e601e69a858e10abf57510f318c4dff75c982c3da607629e0968faa2bbf265ee6639c21fd26bb1a77bf6d0f76cf09dd3224052fec1ddb8bb6d0b97c5b3fa16f9d83302b56088c6aa12e5b8e77780dc95992c894c5938354bcc12adfe40d81c463bb9b0078283c2a0bbbc28176579dd7bc12c04d5fc61c20eebc19ec370e0733b4b6a2547ea0c57f8608d6acaa62c2b6d4fd012f2d670f948bdef7b9291a04dfccad2d17954bf401bd2cd8548a44df50bba574c54202fbcb9543e6ba366f0ececa3093c5dfc81cfc7d8cc3e10bf52183d3308728bc29b224754aad0b7318d0e8334c39d67f65fa033e76a980940c37cb7de4c8a88181c365ac13ad30a350f0580cd1a83f8af441f92e35d35f24d29a5e06b47f53f3d5c0afd9da4534e31df0fd0b4f91d24e49027f2537139ebcd98807db52e21069ca4e9b666f60cb46a99fb992549656d0645e6757b4e6de1d31eb6ffa08c191153271b7af65145f5887e041ac55f0ea81aea525825326a0177eabc324ed25d2418c7a52536f78602b9ff9351f4f8222be7797208b44a4eeec559718a8e2dfbe5dedc4db0bcc1777065203a6da2adb91dcea8193c9f8449523544bfae66df3c250cd9e480cd0b060c03227ba5df804d395c75b228a54b09e6ee73ab6ff0a04543e5e3ac9584dcece6a154950d103ffe14c8de9cf340cc828d31b07d9f90a8e508518f74c258848b8afee9ae1924127c89e6955e26e45bbd27c58ac742918675f5e7d154917e3189cc1041f025a424fbbc80d17b5209241f98149db20158c387df14334854b3d42e1800ff235575167c574a013a354b69c14e01942e2ab09922e7a4a14c364e7722061456c5b3ffff6b93d51a55a30f221df45ca256852e0741256fef67b1b0f88a1a58f7c46d9e6f2c3f2aa0013dada354d4713d48eb5ae51d64efd2598f3243ddb8f877d6d9358077c3337035d5b7ab3ce3b5acedf601ce269cac4a977410c47b053e053168c63617d51589023e9a5842907b973255cedb47fada57881e686dbf9554dbdc263066c7a6e67e00356ae87a8bbc531be178e58d70ac66f37e9c5b61ff3f61e2ddbc77d1be360df0cb9dbc5c4650d7b0b7861121992f26aef31e75af28bbe16ecebcdd67dd3a391dbc4016bbf45ff4d7b1ce81065883f86af9cbd59034bd29a5bca9db2971dadd8e22aaa43eb8f4d1ddfb0b6c20c6f08f54f42fbf0bf178cfe397f77bbc398ab0f5e18c8c40347c55ac2f83334d9cb09c2e89a9754fb33d6c77c4f2c3a8cd41869fc89dd7d1df408edb5b2c3cac1adad8be42eb1311bcd86a3d854b5b4c4c629b020b0c45660a69b52a261052e62a43292ecdd298ff563e5b54a6513369cf8a599d5e0d4f74131d59272cf84aa39d45985d49bf37f6a484e9a529591922092c2251981ea159c2f0c9962793043b1ba35f7ca945efc3564d377230f697e4c9e8d4146c251f74616fd8bf5c000e6eb4fda650182fe13f417e28e7323115dbad7733df6588adbd9f9423a1f14029b2e0cbc4f72a6e442058964a6fe0877295df92e7daec169c7b7b46d5268658b876b5694afca18ccecae02be618e4a4fc55de5298030a6b3bc9d545a8e20420785b8175a185d97d2edd1bf261846e672b517d5566705152f6078f623e08ecd9d4d6e26a4471a2f2dddabf22f4cc0d3d29ddd4d7d2ba2ad06b9d0144a467d7d47a327aff91c60d80cc5e6fc95028d0685ea89d71de69b79cdab5878797bf521fad72a359c3a413cd07ba0a8a21754dff1d5d47af83f58ebe3e8b9d81832fc3cac4d4b89e7ebc5c43aa4c849deb2ac24f8d2f52532afa275d7af0547e0063bf6bd341911faa704564aff5ed529ba2f7b136b793ec7f9dd1146bb7b9fd2b800402c2af68a3a8c15a7de6f63f09ed0f9351216ca949eef54babbc2caa7bed296f472c64067d7e42d8cc013b5ef986eba8980e9a314361506c9bd90ba3d416d1a65b5a7bde810f6ae3ffeb1412be0624cde1a6dfacc53d1fbac3fc6d9bb0d23e6e42d9a9d8fad2b6e5dd93c926f3e66ac81b85bef19223438bbe91ce417f0a3087b3c4b5a7fa663e3cf11a835af63473b03f753ad836ed1bd75509cc61c18f2d0877badf6d80518e161e495534c6aab37b717f220ae0aee1b2f66dbf91062bb0476f7e33ef03b02f7cdcb73c2c45e7873c4b1ef8fc144164c54edba3bef3295f23b5bd114d19211876eb8dfaec06af981e124d176bfd94f48b01b4d8b667048f528fcc4f53b2ce08dbc49d335b2a097a4160c76520359385c5631ea0d3ad431e6fe27ee438300aa492d533ee2e230f67c62f2858842d6749f954ad3ec2fd1415adbac90e63a949d09dae3ea4359f18bbcd93977083b5271340672acc42f0c5d5d9570f02ca2250ab4f9186159977b80582a5858a18e284e3cd3e8b9b97050ad8b9e1f90009103f9cadc981f8d83cee8fb873ad69e3e5538b3caf562d432c88fd12faae0863db6450f5abbd59e338a382aefbe741a9ea31f114c2cca2f7c10b9c827fabb0ee72f92abd6f336c37887a1abd8166b20b475f3e11a052aa1067beedb16600ece61370c340f3c0f35b655f79c5792868117c96b12cace4d797886c5244d827d675524e519bf52b1743b84d50f8276b57b474b8f17e39dbeac9fa0bafb5bea1311560da4e95742feaaf3b3f48fcf5032915c73223f3033a08e495c85e3a173015a07ca27bf101620a35ecec6150faea4117cdb547f7797d914a6a2dbe325e5bdc5f873fefef66cc23882a8dc3dd11cd45f2d56936c5f34d497611b6da692f4993a43f3dbf0a7df3141e7a680001133685350fc08e5030a3ad30d502116acdc45ed617a1463c6706d9dd4a1257803c556109c40798f7105cddf23b6a42e94312f2e678b37d2edf579917d27c4cc400fcc5898f8be911ffe13ff5dd30c4ee5b3e383b5e3553056b83ffb6302dbe5a869936d38562b38bf23d167cb91a735eb9057c80e877fa23d3d7c2088850aaae29f597c432aa83d424c4af9c7a541aff13354f1de60cf3ad061a75e14df6287ab02125fc9619a86d6b59bc88f05c0edfc9b745a92e553c6099d1ee19aa82d820d5704d2d3fc296d68549df41ff026599bce957933c727249a665c4101de0e99ed6e0c50722982a5452d5f601e34ea800cc88081506b89176e285eac135f7508a83527ad2fb115fbae41eebb0bfedc00ba1cd241e414ef5225de097b7ac463542f0654c16f61474bf94660db45a54274062676183d5d70a72c7147b11d1ebb3641ec0cac0a2ab1e9a29208f04f1b4c11501011c5b7fd6feeccf2f01f4f2a851f980aefbf22e23a25e4429af14c270325512ddd00e6051e054fa7af059fb9f05fc50a86cd3646ca54a2f6506ee4e4b53b6f3683c7ce076b15f79afe4d7a1abd3efb0e3883f0bd5c374825da3721fbabfd798990906e7e6e817936023b5cfe8d18af3289ff8230915d3058d5b244cc3c126de240299dba25d5798f9d228809e9e1839ce7e714db9e9c401d1febb47f51bdff878d4ca9d43a42c8fde670b804fab59d723bfe5085d4fd1b23a7190c6a14a7b7690636169c76c80f83b3334264af0bb8e4dd765af711390041b3425e0e4991e81e8e912ed3792421aeedd0941e607810fb3d008302ddb0364c6b51e012e5754b1e0f12e78863a3de7ecc314a5a82fa6162643d30e8165e77c6166be06061afdfeca01c8ff52e316c7c0514ebb5ac3ebd39d3db3fb13412b209cdd66b0899f837810a4a1240a4d3de1a23fe47c969161908cb80643fae57ae5fccfbcf0fb5c950695d062253dac4aff28939494a1bbd1a3edd665f3b78ffbfd04627ff956aa6f1a1ecf1f69e4297932aeb246c313954835253e54c396782e32b0d83f00f500fc10a9dabc2c958f0375f321afec2ad082fe61e0f8d80eea00ddfbf7033efde86b8e856f108f21f6f4de47a426be30f56367cacc80dc1f2ce37901e026f40bb7e7a35d5e9cb4b747f42892b3befd102654d3ab2f7efb48a6593385926e54f20cf97cdfe015416dcd3007324317b402103ced2fb0936983265b03f9e27e40a4b3ef7ea4c9eedff5fc5710cfc1a01d29a0955d18c3f0315d056b449475d6dab936de455c3434b5975c87ef94493a638b2146844e5891373cc7e62f1b9cb64991f7819d004021f435720ede3f256ada5e6eac645007c8c9d2bfb8a93074299202699af1f94f3d033fb718f57e3dced428e7876cfb143615d6539b70751f7e6e3e1ae6d6d2fa4b33eaf913eaa182aada82567dc98161d57e3d8142559993c45a8999fea53bd2af9917b71ed1ad1cdd4a97bc9e5d3bf387ce02eab4699576505f0a2d1d33f0c13bc4f8301dab109ebb1abf1b1aee24ceec0cf3c74bfc5d9da05e99b7b562be855b2c8f79a655f72a64af7c93] */
