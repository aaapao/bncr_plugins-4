/**
 * @author Heyboi
 * @name 青龙日志检测
 * @origin Heyboi自用
 * @version 1.0.2
 * @rule ^日志检测$
 * @rule ^checklog$
 * @rule ^(checklog|青龙日志检测)(开|关| on| off)$
 * @admin true
 * @public false
 * @priority 99999
 * @cron *\/30 * * * * *
 * @disable false
 * 
 * 说明：
    1、（必须）在红灯区同级目录创建一个文件夹，名字随意 如：自用插件
    2、仅超授可用
    3、设置 （panelIndex） 执行面板 对应红灯区奶酪棒位置，从0开始
    4、设置插件开关方式二选一：(默认插件关闭)
        方式1：管理员发送set Heyboi checklogSwitch on/off 设置开关（on为启动插件off为关）
        方式2：管理员发送 青龙日志检测开/关 checklog on/off（英文中间有空格，中文没）
 * 注意：
    本插件只针对运行的任务进行判断，去重列表每天刷新。
    excludeKeywords过滤是匹配青龙面板的任务名称，必须一字不差！
    有些脚本接口本身就是403或者493，请及时过滤以免频繁重拨！！！！
    定时（@cron）自己设置，默认30秒
 * 更新：
    5.12  1.0.0版本发布
    
    5.12  1.0.1  支持指定临时日志存放地址，支持推送到第三方bot重拨
                 使用tgBot推送检测日志，支持日志检测开关

    5.15  1.0.2  支持指定日志检测,变量名：checkTask，指定任务检测和任务过滤互斥
                 如果都有值则以指定日志检测为准。


 * */



const fs = require('fs');
const QlMod = require("../红灯区/mod/AmQlMod");
const AmTool = require("../红灯区/mod/AmTool");
const axios = require('axios').default;
// 临时日志存放地址
const filePath = 'BncrData/plugins/自用插件'
// 需要运行的面板编号
const panelIndex = 0
//指定任务检测,格式为['京东资产变动','东东农场日常任务']
const checkTask = [];
// 任务过滤,格式为['京东资产变动','东东农场日常任务']
const excludeKeywords = ['京东资产变动','汪汪乐园每日任务'];
// 匹配正则
const regex = /IP 493|ip已被限制|code 403/
// 重拨触发词
const key = '重拨'
// 重拨词发送参数,user_id,group_id默认为空，只有第三方bot重拨才需要填
// bncr重拨插件填写会导致无法触发
const push_info = {
    platform: 'HumanTG',//推送平台
    user_id: '',
    group_id: '',
}
 /** Code Encryption Block[419fd178b7a37c9eae7b7426c4a04203d45e01cd4c8344ffddd8d874f1b64a318191f9514b98d644c03366d9e6625065bb3ada9d277a8f6fb930971e0048b983682a0a997b598f726353e8fdd7adfb165df28759839b20c3a9875fc9fb97aa312c3cef47afe588ed865f3bd39d741abfae8b522d26d6b1935efa27cc3c01cbf3c63d4e1908df90e02a75723a78ecc0f754d87f8f625984627349bded7b173800fbc0c4936e3eb090d57a82671ce51c99f97116e71bda12e3c3a7d353d357e4afd558c5a3c3fa47ec2cd7c924e37ab3c2bec8efa5317b3e6b823884aa8a0c49e8619e2be4d369b13afce7abed7d077e2beffbcc0b51cadadc1cd9764aff3270bf18d28eb1f4a2c7fed827bc6f874998e51e2c456a4c5fd0d13edfb7a93f4597990017046973900ba1982984677d866d289425642e2abb0ec9e1b44e14ff4a8d1d9adb9e5bb03be10ec5c0d89b58ac556868050cfaf710ab51a6e41f372afc5c6e7a7ccbf038f418f616bbdfa140bf0194767a7748159e531330089c4c63a04d4a2d5d32fbd239d40a971b83ab41e9d44459943acc85e7a3c1953b1fb7448dde9ee8c06ec24643355ad15a86a30833aff469158c605aa3f700a683d8a4c1a150483a98cf9f9c7a760b1b5ffc5b14e9db2a4076b4e2e11ebd59c021188aad3e537953f6af3682541a349835977bc6ab3d75823b6bee0f9bfb1ab721929bd448987a257d0f902296fdfe6a10002d51590ba7af39cc8d250772e63aae3c5fa12da9683fec3c2b615aa54e941fec4f55a063158475f054ecaca68dd8a6ad124c98be5ff1dab330643d0943fe49d1b09bc1c2813283dc7b9ca5fc594f1518183273901e07d39c9efc37711258b4f59f0593d2f85f1716049c92c3d4eff0e82b5c2cfafe3d1350b1980219cdbbe1845d8b43465835d24fb91397994ec76c0919f6a37153eb640314172e7d7cde586c92ccff7ad8017a815911eb27eea58f221a2006d1e2cff376844875328b879553e5c69bb2484a87d3f473f55a2e76d504911ff3b52c4ba47b426d71779ac057ed728bc605dd12634da532c85ca4c97b490c387f95ac7ed35c9183b5636dc92d30e725cf98e831222789983b2a38d950f064fc2608ecad61f36719f7fa72fd1af473f7f6c50394bba13cc5427bbf8c4c8e88127286536b74be5df243bfa3fa4a0208a4f4589a41b0db6e211c444ab7f77483f3e9ff1e82c87589ec187a393aec3e9a9550d49d609bfa6dbec91be2dc3a0e9d56c64e98fc48428d43c4a4812ee314014fb3bc2c9b2efc038f71f2bb30b69ebb4e563f9c61d170bdd17836015f3aaa0baf32f4048a739d84f8b88855d344bf517d6b9713865c7524c98ff2d14d81538ca942ec96aaeab83dc56619372d0144e789660f2032fd79f21e0dfa486cb89d699f5e99682a7c6189983daf7df452c0ad6ec8e5885943ecdfcb30157eeb89e8e7752a6cf18e6e5cee09456b21c16fd32661d642cadb120b462379b8791252ebb7fd726546e750daea6ee9ac6aa25f392d47da21b174ea69dcaf2bf4e4c06d63c29aa6b34aacaeb40f41f41042b1708a704f3b6d3f51cef6b1b8e13e0bab87a29729778617922694c2e9434ef7b71bd33fc38a152a9959728e839a98553ed251dfddc2290ca70a76b868dba57058f9f7750326dccb5435593c94f5e634c340e51893c1e58b6d10d48f8fd344476c47ee7e0ce725cb0b8faa76d1e099c306cf6784149062575aa2553056b8cc2b8997e51943ca6acf6ca3fc4ee207f604a1ef7c28ad4a0f0887916b4ef51ef696efe2d33394a305b72ee66a53ba0dedb550b324bcb0525e9f9e21a9b664856721b44498a07b671aa2c293e6b27b0ab7395de851e612715d7c16a9049983b77951194a9bf744edff41a5d11ead4216808903b5181c4cf12be8ec9895ef9c683fe134cfc985947463b58bba97cf4d5859f6c8b4bc4fafb85ab4546db18c64f542cfdb1cef79d3edfd3ec73bb25698b81afef3b85029a3d56518adf38cd6917f4d9a63df3128f9f4bbf053b56962981e261c9c753bc35b0c2e55000ede2bba498be1f49fdf7553c4cf7ae89e187eb7d1863b6384803446a5d4ddf0211bfae026368d21bd639ed81791a9da2a4633812e2c5aae1f96d677874490233b711dda54e352853cf7eb809f1424aa807094bf84ad2fde92de42880aa4f04227c04efcd4ba008adb2a4752868fa76ba08bfc361f8c920fd912f8d4ba88a893a6acb485506e570b4c3185b6476f75e9653c3b14bb9c6f520336044e555b0aef270ba4b90d31c7ea64fa3444806ac93d893710aaa32894d662bc52e76af094833c42607f30630390f786e147b309cdcb48953c034ed63764e991dcedce253f74dcb3f81772c495b2d17c86cc8f300237427291cb715ca07f77b3288905d0e89462c745456870fa48281a547c36e3ded9e269276698a0079424ae45866d5e9190a529d611ee3161e386758873e3e8366a7a6c48707e2c62f1c1b445c15fc9e58713d46d074eae916f237818ba66652020d25e1cf1d7c97ecf21d412ba7ec563fc0b89cbda3675b5de791cae9d582750a498c4ad1d82f94cfdfa5597e68ffff33d09fee2480cf114a64d159a0063ae39653fe28a92ede0a2d7871a99b20f6c21a1bf8ffaf6e8bc2ba6bbe838ed309ac672f90e49dcc26be05defcbf6ce7594341ca657590162e97dde1a5e33b2d0df6dadb9e48559a430b1f95d3e109b8a99b0dda9f52ca63c88fae5612cc06d01dc68bd2f3ddbca3973190d6afc164ea2a8e22635854ff4e6b3c741b926168563c4f9c8618517c8bb6f0f73ef33eed7eb173f02555a2e657fd6b8b515b2a1b6b05c55a1c93b0e25a5b842fcf03159a31aa593735844a15e0dfe0182f4adf9fb38d035913bee34bf52329ef19286465ee8cbd8c7ddbc70d95a22351e3c4adb5076f6da83ab448e03dccf28f5912b0a254f5d2266a3eb80ff284954aa9d476f84e4f7e9ac9722a49d65f1a2967a862a4bdf2d18ae3603f9f24b39c610eb37cf5b880d165720bfed7a7b45b6b4fe72e0ae2aa74c734b3c9780945ddda65e57da76452a8818e168a7abe1c5c3914d698eae25bf0ed265788f73ddbca8cfad518b1c1445924e4603e6c2e66f5055b3089cb91ec827362418173f8a25e40ed0b43a1f63c2c4727bcd7412dbb5969a9825519dcb0a116dea3ef4f59e6b23390fde4646c27611b28bdec58bd988c77a7f42fde084cedb6ad7c50d895975da9e86099767e216515a0aa4190b2c955d0b4845e7f323b55fe3ee2c607ab4f5671ceb8595b11aec57c1b386bf3a3d1f1015ab317fcb98696344f2a0699e981c8e513ed8a2b4a992f5675a136c1cf4e9fac92d64d91677d39def2d33ec9129e9f07c39b35a89c5a32a1fc056684c8befa96af4bc5f058fa4082d95e3b443ea3e4f7f3d7b283673214fb50a327d2d80c23e1bcb413f432401e51c372206ac12a1d6b034990caca89333ed1c11858f69cd14541a2edface662283a6dc7b1112c6081227a4b52049ea6d2cf0e06102cb779c567161b633420e11cd188c4a0c7165716d4213453f7efc8772f9a936f3b92b896fed028d43a3472b7b0471dc83aeea347a85b1bd9a4f8bbd9268ca7b2c02720d746c5b68a7be9247b1532bcbfb671ba9e81ed0cacf924fe45712a90e2b772e8f5d3a1b2f457d9652161720fef2952eaa200d880553fb58e3405bea600a6ffcd10e25503f23673816027a88feaf79bfdf17ccb8eec1ef5e231c4e71447a185283d07858d7bf3d57236a74bbfa2ffb7bbd0e0ef99115122b8cfc14ee20960d2eecbb5f255a1716073ebc633915e2df202b0a32b81f2640dc85b81f2893aeeb2b33933c5a3c5be86cd569f743123f31727d2c3866006fb05b946f6795e3eebdd7ec8143dde04dd6e36ce31f0f850081420af06e862cdb8308b4ffde823eb72850c2148742dffec1ad3217440f9c622830120797790c7833ab88862b769d4f58bef957809de115343b5e0099074dccc5f8146f66d6da53d37c4fb0df71997ab8feff0e4f8d2b0e0c5080b5b9acc6be692d3d49d92930031251c63ed8ded34951143e57bedbecb638129e7577d425b341eef1147d9863bd3b9d1cf4b9355dd2f3b43b059e8c711b96955de6093f2b19c03c03c06bacd08ae4decb5b0441006f2fcbcaf8e8eafd91381cf8b1f5a33bc6ebebd2e463b3042feb4eb803ab51bd05caade092a6e24b699b6656277a6c4a6cfd3bbb874630e0383b49ef4c20ff7d1fabc024b3903cc0564e3064abf1a9407f5327ad5c94e51ae1585ec4a0bf53cf70e30307fcbb836f9c3af54d2baec222c4ba7463d40ac87c4a66531dcb57fec2131aa62aaa9bb16ca68f498bd2a3375bbdef5612278193982f4837b574acee45707ea0dcbf0f68021526feb177e521165edbfdd38e698096d4845f2cd013c28fedc091a8478abd663994be9bd3a7312525fd68fff9af2bb577077469c8a9e1f7d2fe5ffb2c0d6f62bad461186d4075466a3cd4cf63ab6b3937a03fb1a926f5b52b19269e4dc32c34d392104aab018a032574e339dbb5c99d919401c72fb60652697216a5d11404e2445db5694ae0ce781e26825ab917108db78e444ed866a7e95cf1b4bbf3d470c9f7e1207ed1ca0508168e0b6b9f5728e8890d11e3ad12dfc1e4e73658aa648904208c2fde11fb236390815edebe74eba9d3e58fb89a982bdb47fede827ae299566b2257665d9c103513259ef84b96d39c87d4bea6b386ea61938d1b05540e79f30ec30d5b68abd1d841e61f3df6107876def4d1ff139d545972506839206329686c2cc9472d0de547bbf1ad247625f61b9f81ce811841bd8c0a4fb89c4ddfe8970ba94c062212cfbaecac7eb9eefc8376894a39f05033602de4dbfaecc5d1611dcdfec5ae13e7f25c91480d6a9a37b9746858757e5e5a13ccf934aa7cfa0802b8283ea14fd3529b85824b6c953e7d3b50c1acdecb173acd19bd95f569fad104bf86f1d6e4fc4a09ae91ccfc5cfc59c2843971be5fa1ac5283014ec3e474a49c820930b2593f2dade3090ebb6216ad47c5664f13d9e386e2419e6f1b2f770d950cd43e8c737ca27af55bd5bb6ba392bb198a9805cde424ac4aa28344d0c4a1c1fb2078ab8b98d09c51f8f35243f1dcbf92126f364fd2917839bc9ba169491ebfb33bd2906da95183d5fa704a7f1138ce40ecedaf8946982aa211bf2a06d572bbc814ea8c2bf35992eb9bff5e8d47775346363c82d4f139117abc9cf664794e9e332ccb24e87ea255ea0611e8e1adde9e51a58de8a731fe0037bc5630d0c597d7a2432142c8797942ff0af7842aa1edb1b81cf5ded30be7879cf73390f3c5ed197a2903f8e06797b35470708eff84830972943aec41c96dcf00bf935deac8d4cfa67342c163d2161218b763c1d55736227745ae10afe68c0904801ad63b240f41fa0cf0b5a963e741ac0dc66d0c040c2e0075f456328b9b920cb9c597a4ab46b28acc9401654fbd343f9632abffc2409f6404139f38bd2adaa1b4ac54fc9fffc1faabd455fca4e1104bb35af14e1c0557314393696f46b486b8141d7e11b6385a15deaa8ec5d58aead01ccfa15c688e827e89d7b3fcda8e1266971c8102c83a8ddbc547aaee3a05128e784ca23c2fbda5b9017fae608c8a2a2720f7ef414b2e9c995d5be3395365c6c35741c608e95725a6a578dd3a54fa41dd5956d21d48ccee3b54c24aba5aee7a23c4c0e38f5e3c8eff6c4d1a26414766d7804921a4af0acce84438cc4303fb641f0172e3f904aa8d1a6532586a7701e10e25652f3acc003570275f08256ac5148f0717a8ce8aef408b7a3e29ba4929ac77759b885086df684a1f0bd9e2d6f0f50b8dd25b20a00bd98a00afbdbcc3ee7347e58648570198ee60a8c48acf7d1d07cdb3265b7b8a941ee94a285a1619d118e25f08818964f79a279bf9c7836e77a36eb1da32a2a85e3f6c1414f79788189c2a30a46ca5e5096462d12a7a286486b641201ca6eeb20be6069d544cd3b2970ef84ca899b4e6624aca1fe4bfafee1f32600a48c4856bdefa1e79fee75d6ccedbbffe9d37949277d8a2685d5d145e143d98fecc3248927ce0dd1050bd344ecaf58f2c18e3de5733aa66918c5a5a476c9784c40ae7dc394b264c93acf1db3dadf38c538bbe57dd376e0df55fa46acb93e718bea0ebd14cdfd3c81ebf11f025d73ff2fd754ec22a372bb8616922f2dfe7ff38d340a900c8d693edf57c90ff5bcc0e9718a8afb066737517ad7a7ee923cfb51b75bef553b0d013a9a85c68095ecea8c271b1a270978b199406591430534ae70fc264b7a581fa49efb14964dca19bd50a50939d90d4e087af8773a4176021ae2a35c637cf31c91caf48faf6bbe03b56796d9d684016f56b2c16c6726d8c6ca66d8964dc1601b23e72c3de2e24f6f5758db312da89ea8347e96dcc343d7939a95b44d989c6f49793276061d49f39f27fb85fa4653687a8864dbd5c2f55c8c90d59bf8402ddc0675396e0b1094f30372dd2fbca38ab744f28ce7de8a0f4e5b9c3dbd90f6b2f7c89e739bc9355a573ef61c556247051c097cbc53f49f8511b1d1878bf8ce05219663ed40652e4cb226230ab80ee0a3e5537d6198cf6e4bcd915efa9343f30c7ca66f9b186d0d20237426bffaab63483e8b175abb1bc2c00dc92349584d62b8da67d65288a2de8840384bca858db16646062b4849abd327f1c4b823164cabb7088f6efc38aeadef67babb408727906fd6ac43756cc2fc7581af88141a9e6c9c7f9c7f62250af4b9d83d2d9244f0f76e23e36bbe40bff68840ffe81330ff57ec2e406fc9ab69d08c6159cb600964502a311309dce9334d720699f41df439eaa2e1c3acb2926d9ec67c6677a26451521932f4704598bdaed066c9942341161a1e5b6eb301aaa06bf0bc4d27f112b39a502d53629b4215cf6c4370020a0a830126e06fbcf269e9261891aa4ba848b5de4121741159967a41593439575131c30b5e30bce4b3208433aa056582169008421239f6ad1ef2f39ed165952e0ee899b2bf8601f34af0eebe366cf72a9c330c4dfc0539719c9924e12d0b28758648ea6336da4dadcee566761c6466a727fefc615ca7657aa2d0edfff2a06dd20777913a7559ddbe159a08691a7b61a00e9af048df9f60d0852be6a483d4b4ad28b364e257e6789f8fcd1fead243f11003d01f60466311f139741f1d0240d31126082c72de1f105836064345e74e1f3ea855fe8dc05d2d19a4768855b68821ff201d8d75b1766aabb7107d8732c5f80166c24b5dd4a8b10862fc657bdfdbe06c313a2f316e5f86dad83d443c2b4eeb71091bd8f24ce8ec2980db864122f38e668599a5864230b762ef57ae4b9da7a8b2bb0ac5e69590bf2bc670674dc4bbb4a7462d834cab67206bed10b2ea8d57e952dd583c401b17d653f51da04e8c74c4db7ec8df60c628499b8c657586a3878450b68adea5c84b775da60c0b8a3b8239ac8b5205fa56a99a74e5669b7a73b704326db7c588473010db7ce8e12af2612229f24d091f82113bdc134919a3f25ebb480c4ddd05a81480dd4dd8c181ad394a431a0a8d13ef4229413fdf6e3eec089f43e6ae7c95a486ec4c7bc899143a1fd7eac311d4cf3a9b540d39bf337d082ee4387b9288132503bdbc3b0a8c4da2a8240c1bad399de00771c8ed05206fc8184cf7513480218dd47499c43bccd25fd40c164062da7770561d748f7ae7c6c9abee49a434f0fd52f9103a001fae8473b10ebb44879a1cf9871107db63e76dbc576c25c75b422308c3743ede6f88f6e0df159afa22f8a3e5cae9c13daa3d6a442fe7b6220d840bdf4e5d0a239d4ecbd727b27a60b2f5ae1df62fc76833231197ddf03eb78af679dab8f46b4b30484ed424479ecaa099304151118340baf50402a9a3b7809d163e8db9bcfdece65701a2aff388943a4c3c6d14954ea7785ba5577c18cd69343a67b18c9a4f21ade1bee9317ac6eaac009d0069209ee58cc245c44e295e6be9662e159558f45b06105f1968be1198f6603b0af811581e71df068e097e0ce56a617509e2a02f4a98553ff45820ffcf732bf775022e27d07d9d049cd902e52f80242bc55139d83fc04e0b40ea13f1b4a6c832a8c9782d4fc86c16d78ab49a41506b6e2d6ab82e217c794adec636941f20e40c1c45dd5eaaf04f7d0d5fdbb569dcdabefb806bba38781c86375d55ea61683d9af91ff9e59dd554046ad3a6eabbb1018aafc91129e6402a37108ce4a794e23f57ec0af258742c73550f3db231606770220bca92153264ed71555c4d0c54afe34b1b26b0986502049beef931201353745906f3749f8f79fc2760976594ab42a8a0c7483cfa9527d2843ec2791b22106d0ec8be82ed2b7c4246ebc703f925d306190c8fc42ed08458046f35d6abcfa215200b657b6e1b04ff16daf28f4e53361092a10342617db152b4540dfdaecd904633939d3c88474c399c6725c27c06e69ea6bc9044442886df0aa0d0aa6f76041d185a097ecb38a6786079e21c2e534e4359ca63a912acb242d927b2f728ff2f10c3e00844d18b2ccc78d93e00eb55135d68b1d804090982c2518072f56461787d09a2a66a922800e7a1d7e95731b6908d054711266ebf9bba805820491b372cabaa14c64e3254e0178dc6e3b230bed4eee59f3ec680a56ca7e52626d2e4eb0f2f9c0eb8f02181b1ba6974215f54c916957fbdfeeeec4ad532b3ea1372b7342a0316cb13ca88dbf76bdf5e52b2ce36391a53679f940968119993f603b7e06fc0517544fc1cd30a33f41ed3b1ffebfbb7de58a9a7e8536c11c9b5a5ea221b02adb77db1f1aa7e0931f947ecb57c9cd6914d8d58735030754eef4f83366071b7ea677e91636b0965588c0353566ec300b56b6445acd2dae4b739e33087cfb79c4bb3cd485724b8d62d2bcaf8b67f6571c202bcc78230d9d003af1b42307e128f75f789b4b33c615a8e4ecd03b34196ce1d0eea00bf78ed4a800f10f6d0bfca581545faf83b8623d86fdef6c22044d9ff30ce547c6a1dde5cdd506d5c5b4e24340ae847048981ffc4acce884250ff6c7048ecb3bc0f1eab6df58d3cf440975d853e2a157b3e7199be9b6def7a8e3d1f2fd2c6d03e80aec6ca2e949f9900855f80512594d694500795a0e2bcdb14] */
